# 升级计划

本文介绍平台的OTA计划创建，包括版本包管理、升级计划两个方面内容。
                                   
## **版本包管理**

所谓版本包，是针对不同的模组、MCU、模组内APP需要不同的版本包名称的定义，用于管理不同升级版本包。

### **前提条件**

无

### **操作步骤**

1.登录开发者中心后，点击左侧菜单“设备管理”→"OTA升级"，进入OTA升级管理页。

<a data-fancybox title="img" href="/guide/image2022-3-12_13-45-2.png?version=1&modificationDate=1647053287000&api=v2">![img](/guide/image2022-3-12_13-45-2.png?version=1&modificationDate=1647053287000&api=v2)</a>

2.点击 **“版本包管理”** 面板页上的 **“新建版本包”** 按钮，弹出对话框

<a data-fancybox title="img" href="/guide/image2022-3-12_11-4-28.png?version=1&modificationDate=1647053663000&api=v2">![img](/guide/image2022-3-12_11-4-28.png?version=1&modificationDate=1647053663000&api=v2)</a>

参数说明

| 参数       | 描述                                                         |
| :--------- | :----------------------------------------------------------- |
| 版本名称   | 为此升级包输入一个版本名称                                   |
| 组件类型   | 选择升级包的类型，分为整包、差分包。整包：整包不需要源版本，可以直接使用base包进行升级。差分包：需要指定源版本，用来更新从特定版本到目标版本的升级 |
| 目标版本   | 指此升级包升级到的版本号                                     |
| 源版本     | 只有差分升级时需要指定，用来指定此差分包是从具体起始版本到目标版本的升级 |
| 上传版本包 | 单文件大小不超过100M，可同时支持5个文件，当前升级包格式仅支持.bin,.zip,.rar,.pack,.mini_1,.mini_2,.py,.tar, .tar.gz,.s19,bin_1,bin_2。 |
| 备注   | 用来说明此升级包的一些升级项说明，如bug修复，功能优化等描述信息。不超过200字符。 |

3.点击“确定”，进入版本列表页，可以根据列表中操作栏进行具体版本的查看和删除。

<a data-fancybox title="img" href="/guide/image2022-3-12_11-34-23.png?version=1&modificationDate=1647055457000&api=v2">![img](/guide/image2022-3-12_11-34-23.png?version=1&modificationDate=1647055457000&api=v2)</a>

## **升级计划创建**

若想对设备进行批量OTA升级，则首先需要在平台为这一批次设备建立一个升级计划，用来配置这一批次设备的升级信息。

### **前提条件**

● 已创建产品<br />
● 已添加版本包

### **操作步骤**

1.登录开发者中心后，点击左侧菜单“设备管理”→"OTA升级"，进入OTA升级管理页。

<a data-fancybox title="img" href="/guide/image2022-3-12_13-45-2.png?version=1&modificationDate=1647053287000&api=v2">![img](/guide/image2022-3-12_13-45-2.png?version=1&modificationDate=1647053287000&api=v2)</a>

2.点击“升级计划”面板页上的“创建升级计划”按钮，跳转至升级计划创建页。
<a data-fancybox title="img" href="/guide/image2022-3-12_10-58-12.png?version=1&modificationDate=1647055698000&api=v2">![img](/guide/image2022-3-12_10-58-12.png?version=1&modificationDate=1647055698000&api=v2)</a>

参数说明

| 参数               | 描述    |
| :----------------- |:-------|
| 计划名称           | 为此升级计划输入一个名称|
| 升级产品           | 选择产品，用来指定当前计划主要的升级设备所属产品|
| 设置黑白名单       | 黑白名单用来为此次升级产品做一些特殊情况处理。黑名单：在黑名单中的设备不允许被升级白名单：只允许在白名单中的设备被升级若不设置黑、白名单，则该产品下所有设备升级；若同时设置黑、白名单，则黑名单优先级大于白名单优先级；|
| 升级方式           | 升级方式：用户确认升级和静默升级；|
| 升级策略           | 用来针对此批量升级的一些策略配置。重试次数：一旦设备升级失败，允许重新升级的次数；最低信号强度RSRP:设备上报的信号强度低于此值，则设备不会进行OTA升级；最低电池电量：设备上报电池电量低于此值，则设备不会进行OTA升级 |
| 计划时间           | 可以指定升级的时间段，一旦计划超过结束时间仍未结束，则升级计划会尝试结束该计划。 |
| 选择升级组件及版本 | 可以通过添加新组件、移除来动态调整组件信息以适应此次升级计划，调整组件完成后，可以点击选择版本，从版本管理列表中选择合适的版本匹配每个组件。|
| 选择现有升级计划的组件           | 可以添加现有升级计划的组件，无需创建新的组件|


计划信息配置好后，可以点击“保存”按钮，用于保存计划。

计划状态说明

| 计划状态 | 描述                                                         |
| :------- | :----------------------------------------------------------- |
| 保存     | 创建计划点击保存，计划进入保存状态，此时计划未激活，可以对计划进行编辑修改。 |
| 激活     | 点击激活按钮，计划进入激活状态。此时计划不可编辑修改，一旦有当前计划中的设备上线则会进入OTA升级流程。 |
| 升级中   | 当计划在激活状态后，一旦有设备进行OTA升级，则计划进入升级中状态 |
| 暂停     | 页面可暂停计划进行，暂停后后续的设备则不再收到此升级计划信息，而正在升级的设备还是可以继续升级。暂停可被恢复。 |
| 终止     | 页面可进行强制终止操作，点击终止后，则后续待升级的设备会变成升级失败状态，正在升级的依然可以继续升级。强制终止不可恢复。|
| 结束     | 计划到达结束时间，计划变为结束，即便存在未升级的设备不再进行升级，正在升级的设备会继续升级直至超时或升级结束。 |

